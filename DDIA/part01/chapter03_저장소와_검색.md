# 03장 저장소와 검색

데이터베이스는 다음의 두 가지 기본적인 작업을 한다.
- 데이터를 저장
- 데이터 요청 시 제공

## 데이터베이스를 강력하게 만드는 데이터 구조
***
- 로그: 연속된 append-only 레코드

### 색인
색인은 어떤 부가적인 메타데이터를 유지해서 이 메타데이터로 데이터의 위치를 찾는데 도움을 준다. 색인은 기본 데이터에서
파생되는 추가적인 구조다. 이렇게 때문에 데이터 쓰기 속도를 느리게 만든다 (매번 색인도 갱신해야 하기 때문). 하지만, 
조회 성능에서는 매우 빠르기 때문에 용도에 맞는 적절한 트레이드 오프가 필요하다. 

### 해시 색인
- 키-값 저장소

append-only 데이터에서 가장 간단한 색인 전략은 키를 데이터 파일의 오프셋에 매핑하는 것이다. 값을 조회할 때는 해시
맵을 통해 오프셋을 찾아 그 정보로 데이터 파일을 읽는다. 

그럼 이렇게 데이터를 추가만 하면 결국 디스크의 용량이 부족해진다. <br>
-> 로그를 세그먼트로 나눠 특정 크기에 도달한 세그먼트는 읽기 전용, 새로운 세그먼트는 쓰기 전용으로 사용한다.<br>
그럼 이전에 있던 세그먼트들에 대해서 중복된 키를 제거하는 압축 작업을 수행할 수 있다. 크기가 줄었으니 작아진 세그먼트들을
백그라운드 작업으로 병합도 할 수 있다.
- 장점
  - 순차적 I/O로 빠른 성능
  - 동시성이나 고장 복구 용이 -> 기존의 버전, 현재 버전 모두 들고 있기 때문.
- 단점
  - 메모리에 해시 테이블의 키를 모두 저장하기 때문에 키가 많으면 문제.
  - 범위 질의에 용이하지 않음.

### SS테이블과 LSM 트리
위에서 병합된 세그먼트 파일들을 키로 정렬하는 방식을 정렬하는 방식을 SS(Sorted String)테이블이라고 한다.
- 장점
  - 